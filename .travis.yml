addons:
  postgresql: 9.6
env:
  global:
  - CC_TEST_REPORTER_ID=8e6369201882d69ae19e5b21e9c5d5eab3b84e09e23e485de45516d5f219452d
language: ruby
cache: bundler
rvm: 2.6.0
before_install:
- gem update --system
- gem install bundler
before_script:
- psql -c 'create database instagram_challenge_test;' -U postgres
- curl -L https://codeclimate.com/downloads/test-reporter/test-reporter-latest-linux-amd64
  > ./cc-test-reporter
- chmod +x ./cc-test-reporter
- "./cc-test-reporter before-build"
script:
- bundle exec rails db:migrate RAILS_ENV=test
- bundle exec rake spec
after_script:
- bundle exec rake coveralls:push
- "./cc-test-reporter after-build --exit-code $TRAVIS_TEST_RESULT"
deploy:
  provider: heroku
  api_key:
    secure: 0cgA9cNhBU8NRLP+ir+ibgjtva683DZa6aFARjl5ZhwNl3DMNG9l8HncdWFtp53Jc92TXfZG+sLzazLg9VrFjHfwcVHf5JqS5dgDkYE1n5OH5z5ZdnTOf3d69jxQiNrQqW8WiLldk63EKXticg+IB/Ie8NCqHABi8aGsEzWxVdVx9czt8yP5CGvlzmVVL0nF9+qBG+l1p3daxkgViMc4wBpSyXgzIeVlBYbJ8UQC031Pi2yvku7z/zzrCw6UAYkaOhjo2bwLA+TxO6IU/3lzTrw8cb2O9bVwEU6+9oCSR7wDs/bRCRQsus0+jtWT/QJr/9ZXF3YR7TE85yODAZtfOjXI3kzXDYtmnF/h0pAR8FVx0Ea9MyiWR003CtmepHkadA4I5r/UxvarZMOZbnjx7sFXSqS4BmEHUfz68cLt3ektccx8IY/o2NKTyz6n/3WuWGz6rAylgEXH6blHfObIpTuV6tBPDh+d1nsMJ2XvqsK6BCA1omX8GgZGUxPBPwoYPcBcfQRWlCwpqSYs9sD3iJ7/RCnjWmPM8iIFfYNeJCTo42J+8BoCKfikmHBAEMjq1jFZ3edZjQ+qE69HqkWvGPdlNU8cqbQ8Jh7mpY3CZyhNafQ1hg7zXhESbqJp7yEIPYNky6PW6FsdSqyOuN8i1IMBCgY2BKYmQu0a6+FQ9kg=
  app: dt-instaclonegram
  on:
    repo: dafuloth/instagram-challenge
